<!DOCTYPE html>    
<html lang="ru">    
<head>    
  <meta charset="UTF-8">    
  <title>Смотреть фильм онлайн бесплатно</title>    
  <meta name="viewport" content="width=device-width, initial-scale=1">    

  <!-- Шрифт -->    
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400&display=swap" rel="stylesheet">    

  <!-- Kinobox CSS -->    
  <link rel="stylesheet" href="https://fbphdplay.top/kinobox.css">    

  <style>    
    body {    
      margin: 0;    
      background: #000;    
      color: #fff;    
      font-family: 'Montserrat', sans-serif;    
    }    
    .container {    
      max-width: 1200px;    
      margin: 0 auto;    
      padding: 10px;    
    }    
    h1 {    
      text-align: center;    
      margin-bottom: 20px;    
      font-weight: 400;    
    }    
  </style>    
</head>    
<body>    
  <div class="container">    
    <h1 id="title"></h1> <!-- H1 для названия -->
    <div class="kinobox" id="player"></div>    
  </div>    

  <script src="https://fbphdplay.top/kinobox.js"></script>    
  <script>    
    const pathParts = location.pathname.split('/').filter(Boolean);    
    const type = pathParts[0];    
    const kpId = pathParts[1];    

    const titleEl = document.getElementById('title');    
    const playerEl = '#player';    

    if(!kpId || !['film','series'].includes(type)){    
      titleEl.textContent = 'Фильм/сериал не найден';    
      titleEl.style.color = 'red';    
      document.title = 'Фильм/сериал не найден';    
    } else {    
      const apiKey = "a5b27826-b5b3-4e1c-a7d6-66facbc3743c"; // твой ключ KinopoiskUnoficial

      // 1. Сначала получаем название и год с KinopoiskUnoficial
      fetch(`https://kinopoiskapiunofficial.tech/api/v2.2/films/${kpId}`, {
        headers: { "X-API-KEY": apiKey }
      })
      .then(res => res.json())
      .then(data => {
        const name = data.nameRu || data.nameEn || 'Фильм/сериал';
        const year = data.year || '';
        const fullTitle = year ? `${name} (${year})` : name;

        // Обновляем H1 и заголовок вкладки
        titleEl.textContent = fullTitle;
        document.title = fullTitle;

        // 2. Инициализируем плеер Kinobox
        kinobox(playerEl, {
          baseUrl: 'https://fbphdplay.top/',
          search: { kinopoisk: kpId }
        });
      })
      .catch(() => {
        titleEl.textContent = 'Не удалось загрузить фильм/сериал';
        titleEl.style.color = 'red';
        document.title = 'Ошибка';
      });
    }    
  </script>    
</body>    
</html>